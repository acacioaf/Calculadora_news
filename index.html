<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEWS2 - Hospital Santa Marta</title>

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#f26522">
    <meta name="apple-mobile-web-app-capable" content="yes">

    <style>
        :root { 
            --hsm-orange: #ccc; 
            --hsm-green: #553d8d; 
            --hsm-green-light: rgba(129, 218, 117, 0.123);
            --bg-gray: #b1f1cc1c; 
            --text-dark: #1a1c1e;
        }

        * { 
            box-sizing: border-box; 
            -webkit-font-smoothing: antialiased; 
        }

        body { 
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; 
            background: var(--bg-gray); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
            padding: 15px; 
        }

        .app-card { 
            width: 380px; 
            background: white; 
            border-radius: 20px; 
            box-shadow: 0 12px 40px rgba(0,0,0,0.12); 
            border-top: 6px solid var(--hsm-orange); 
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        .header { 
            padding: 15px 10px; 
            text-align: center; 
            background: var(--hsm-green-light); 
            border-bottom: 1px solid rgba(137, 141, 61, 0.1);
        }
        .header img { height: 50px; margin-bottom: 8px; }
        .header span { 
            display: block; 
            font-size: 12px; 
            color: #5d6126; 
            font-weight: 800; 
            letter-spacing: 1.5px; 
            text-transform: uppercase; 
        }
        
        .content { padding: 20px; }
        .row { display: flex; justify-content: space-between; margin-bottom: 12px; align-items: center; }
        label { font-size: 13px; color: #444; font-weight: 600; flex: 1; }
        
        input, select { 
            width: 160px; 
            padding: 10px; 
            border: 1.5px solid #e0e0e0; 
            border-radius: 10px; 
            font-size: 13px; 
            background-color: #fafafa;
        }
        input:focus, select:focus { 
            border-color: var(--hsm-orange); 
            outline: none; 
            background: #fff;
        }

        #res-container { 
            display: none; 
            margin-top: 15px; 
            border-radius: 12px; 
            overflow: hidden; 
            border: 1px solid rgba(0,0,0,0.1); 
            animation: slideUp 0.3s ease-out; 
        }

        .res-header { display: flex; align-items: center; justify-content: center; gap: 15px; padding: 15px; }
        .score { font-size: 42px; font-weight: 900; line-height: 1; }
        .risk-title { font-size: 16px; font-weight: 800; text-transform: uppercase; }
        
        .conduta-box { 
            background: #fff; 
            padding: 13px; 
            font-size: 13px; 
            border-top: 1px solid rgba(0,0,0,0.05); 
            line-height: 1.6; 
            text-align: center;
            color: var(--text-dark);
        }
        
        .acao-texto { display: block; font-weight: 600; margin-bottom: 10px; }

        .sepse-alerta { 
            display: block; 
            margin-top: 8px; 
            color: #b71c1c; 
            font-weight: 800; 
            text-transform: uppercase; 
            font-size: 11px; 
            background: #fff0f0; 
            padding: 10px;
            border: 2px solid #ffcdd2; 
            border-radius: 8px;
        }

        .verde { background: #e8f5e9; color: #2e7d32; }
        .amarelo { background: #fffde7; color: #f57f17; } 
        .vermelho { background: #ffebee; color: #c62828; }

        .btn-limpar { 
            width: 100%; 
            margin-top: 20px; 
            background: none; 
            border: none; 
            color: #999; 
            font-size: 11px; 
            cursor: pointer; 
            text-transform: uppercase; 
            font-weight: 700;
        }

        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="app-card">
    <div class="header">
        <img src="logo_topo.png" alt="Hospital Santa Marta">
        <span>ESCALA DE NEWS</span>
    </div>

    <div class="content">
        <div class="row"><label>Uso de Oxigênio?</label>
            <select id="o2" onchange="calc()">
                <option value="0">Ar ambiente</option>
                <option value="2">Suplementar / Fluxo</option>
            </select>
        </div>
        
        <div class="row"><label>Freq. Respiratória</label>
            <input type="number" id="fr" oninput="calc()" placeholder="12 - 20 irpm">
        </div>

        <div class="row"><label>Alvo de Saturação</label>
            <select id="escala_sat" onchange="calc()">
                <option value="1">Geral (Alvo ≥96%)</option>
                <option value="2">DPOC (Alvo 88-92%)</option>
            </select>
        </div>

        <div class="row"><label>Saturação (SpO₂)</label>
            <input type="number" id="sat" oninput="calc()" placeholder="≥ 96 %">
        </div>

        <div class="row"><label>Pressão Sistólica</label>
            <input type="number" id="pas" oninput="calc()" placeholder="111 - 219 mmHg">
        </div>

        <div class="row"><label>Freq. Cardíaca</label>
            <input type="number" id="fc" oninput="calc()" placeholder="51 - 90 bpm">
        </div>

        <div class="row"><label>Consciência</label>
            <select id="acvpu" onchange="calc()">
                <option value="" disabled selected>Selecionar...</option>
                <option value="0">Alerta</option>
                <option value="3">Confuso</option>
                <option value="3">Resposta à Voz</option>
                <option value="3">Resposta à Dor</option>
                <option value="3">Irresponsivo</option>
            </select>
        </div>

        <div class="row"><label>Temperatura</label>
            <input type="number" step="0.1" id="temp" oninput="calc()" placeholder="36,1 - 38,0 ºC">
        </div>

        <div id="res-container">
            <div class="res-header" id="res-color">
                <span id="res-score" class="score">0</span>
                <div class="risk-info">
                    <span id="res-risk" class="risk-title"></span>
                </div>
            </div>
            <div id="res-conduta" class="conduta-box"></div>
        </div>

        <button class="btn-limpar" onclick="limpar()">Limpar todos os campos</button>
    </div>
</div>

<script>
    function calc() {
        const f = document.getElementById('fr').value, 
              s = document.getElementById('sat').value, 
              p = document.getElementById('pas').value, 
              c = document.getElementById('fc').value, 
              t = document.getElementById('temp').value, 
              a = document.getElementById('acvpu').value;

        if (!f && !s && !p && !c && !t && a === "") {
            document.getElementById('res-container').style.display = 'none';
            return;
        }

        let score = 0;
        const o2 = +document.getElementById('o2').value;
        const escSat = document.getElementById('escala_sat').value;
        
        score += o2 + (+a || 0);

        if (f) { let n = +f; if (n <= 8 || n >= 25) score += 3; else if (n >= 21) score += 2; else if (n <= 11) score += 1; }
        if (s) {
            let n = +s;
            if (escSat === "1") {
                if (n <= 91) score += 3; else if (n <= 93) score += 2; else if (n <= 95) score += 1;
            } else {
                if (n <= 83) score += 3; else if (n <= 85) score += 2; else if (n <= 87) score += 1;
                else if (n >= 93 && o2 === 2) {
                    if (n >= 97) score += 3; else if (n >= 95) score += 2; else if (n >= 93) score += 1;
                }
            }
        }
        if (p) { let n = +p; if (n <= 90 || n >= 220) score += 3; else if (n <= 100) score += 2; else if (n <= 110) score += 1; }
        if (c) { let n = +c; if (n <= 40 || n >= 131) score += 3; else if (n >= 111) score += 2; else if (n <= 50 || n >= 91) score += 1; }
        if (t) { let n = +t; if (n <= 35.0) score += 3; else if (n >= 39.1) score += 2; else if (n <= 36.0 || n >= 38.1) score += 1; }

        exibir(score);
    }

    function exibir(s) {
        const container = document.getElementById('res-container'),
              colorBox = document.getElementById('res-color'),
              scoreDisp = document.getElementById('res-score'),
              riskDisp = document.getElementById('res-risk'),
              conduta = document.getElementById('res-conduta');

        container.style.display = 'block';
        scoreDisp.innerText = s;

        if (s >= 7) {
            colorBox.className = 'res-header vermelho';
            riskDisp.innerText = 'Alto Risco';
            conduta.innerHTML = '<span class="acao-texto">Avaliação médica imediata.<br>Monitorização contínua.</span><span class="sepse-alerta">⚠️ Atenção: Sugestão de Protocolo de Sepse</span>';
        } else if (s >= 5) {
            colorBox.className = 'res-header amarelo';
            riskDisp.innerText = 'Risco Médio';
            conduta.innerHTML = '<span class="acao-texto">Avaliação médica urgente (até 1h).<br>Vigilância aumentada.</span><span class="sepse-alerta">⚠️ Atenção: Sugestão de Protocolo de Sepse</span>';
        } else {
            colorBox.className = 'res-header verde';
            riskDisp.innerText = 'Risco Baixo';
            conduta.innerHTML = '<span class="acao-texto">Manter monitoração rotineira conforme o protocolo da unidade.</span>';
        }
    }

    function limpar() {
        document.querySelectorAll('input').forEach(i => i.value = '');
        document.querySelectorAll('select').forEach(s => s.selectedIndex = 0);
        document.getElementById('res-container').style.display = 'none';
    }

    if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js")
    .then(() => console.log("Service Worker registrado"));
}
    
</script>
</body>
</html>


